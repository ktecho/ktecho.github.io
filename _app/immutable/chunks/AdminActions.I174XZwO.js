import{v as I,s as de,P as ee,Q as te,h as S,d as v,j as p,i as E,z as y,r as R,e as C,y as we,f as x,a as N,g as T,c as P,F as be,x as Q,l as G,m as F,G as me,I as ke,n as q}from"./scheduler.2vmdsppc.js";import{S as he,i as _e,a as A,g as K,t as j,c as L,b as U,d as Y,m as J,e as X}from"./index.eLAHt3dB.js";import{D,al as pe,G as ve,I as ye,e as V}from"./utils.FkBaGfnY.js";import{P as xe,M as Te}from"./Minus.b0sP7xD2.js";const Be={text:{title:"Text Block",description:"This widget allows you to write a text to explain something to your customers (about me, about this site, ...).",items:!1,max_num_available:!1,markdownText:!0},products:{title:"Selected Products",description:"This widget allows you to be able to select which products you want shown on this section.",items:["products"],max_num_available:!1},products_with_slider:{title:"Selected Products in a Slider with text",description:"This widget allows you to select which products you want shown on a big slider with a description. The slider will show the product's title and description by default, but you can change that to other text of your choice.",items:["products"],max_num_available:!1,markdownText:!0},stalls:{title:"Selected Stalls",description:"This widget allows you to be able to select which stalls you want shown on this section.",items:["stalls"],max_num_available:!1}};function W(i=I(D)){return!i.content||!i.content.pages?{}:i.content.pages}function H(i,s=I(D)){return!s?.content||!s?.content.pages||!s?.content.pages.hasOwnProperty(i)||!s?.content.pages[i].sections?null:s.content.pages[i]}function M(i,s){return H(i)?.sections[s]??null}function Ge(i,s,l){let e=M(i,s);if(e.title=l.sectionTitle,e.params===void 0&&(e.params={}),e.params.sectionType=l.sectionType,l.maxProductsShown&&l.maxProductsShown!=0&&(e.params.maxProductsShown=l.maxProductsShown),l.markDownContent){let t;l.sectionType==="text"?t="sectionText_"+i+"_"+s:l.sectionType==="products_with_slider"&&(t="section_products_with_slider_"+i+"_"+s+"_"+l.lastProductPassed.id),pe(l.markDownContent,ve(t),()=>{console.log("markDownContent saved to Nostr relay!!")})}Z(),$()}function Z(){D.set(I(D))}function $(){let i=I(D);delete i.homepage_include_stalls,pe(i,ve("site_specific_config"),()=>{console.log("Configuration saved to Nostr relay!!")}),ye.set("Configuration saved to Nostr.")}function Se(i,s,l,e){let t=M(i,s);t.values||(t.values={}),t.values[e]||(t.values[e]=[]),t.values[e].includes(l)||(t.values[e].push(l),Z(),$())}function Ae(i,s,l,e){let t=M(i,s);t.values[e]=t.values[e].filter(n=>n!==l),Z(),$()}function Fe(i,s,l){let e=M(i,s);return e&&e.values&&e.values.hasOwnProperty(l)?e.values[l]??[]:[]}function le(i,s){let l=[],e=W();return e&&Object.keys(e).forEach(t=>{Object.keys(e[t].sections).forEach(n=>{e[t].sections[n].values&&e[t].sections[n].values[s]?.includes(i)&&(l[t+"-"+n]=e[t].title+" / "+e[t].sections[n].title)})}),l}function Ee(i){let s,l;return{c(){s=ee("svg"),l=ee("path"),this.h()},l(e){s=te(e,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var t=S(s);l=te(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),S(l).forEach(v),t.forEach(v),this.h()},h(){p(l,"stroke-linecap","round"),p(l,"stroke-linejoin","round"),p(l,"stroke-width","2"),p(l,"d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),p(s,"xmlns","http://www.w3.org/2000/svg"),p(s,"fill","none"),p(s,"viewBox","0 0 24 24"),p(s,"class","stroke-current flex-shrink-0 w-6 h-6")},m(e,t){E(e,s,t),y(s,l)},p:R,i:R,o:R,d(e){e&&v(s)}}}class Oe extends he{constructor(s){super(),_e(this,s,null,Ee,de,{})}}function se(i,s,l){const e=i.slice();return e[7]=s[l][0],e[8]=s[l][1],e}function ie(i,s,l){const e=i.slice();return e[11]=s[l][0],e[12]=s[l][1],e}function ne(i,s,l){const e=i.slice();return e[15]=s[l][0],e[16]=s[l][1],e}function oe(i){let s,l,e,t,n="Admin actions:",o,f,g,u,a,d,r,m,k;g=new Oe({});let h=i[3]&&ae(i),O=V(Object.entries(le(i[0],i[1],i[4]))),w=[];for(let c=0;c<O.length;c+=1)w[c]=fe(se(i,O,c));const ge=c=>j(w[c],1,1,()=>{w[c]=null});return{c(){s=x("hr"),l=N(),e=x("div"),t=x("p"),t.textContent=n,o=N(),f=x("div"),U(g.$$.fragment),u=N(),h&&h.c(),d=N(),r=x("div");for(let c=0;c<w.length;c+=1)w[c].c();this.h()},l(c){s=T(c,"HR",{class:!0}),l=P(c),e=T(c,"DIV",{class:!0});var _=S(e);t=T(_,"P",{class:!0,"data-svelte-h":!0}),be(t)!=="svelte-1laqccj"&&(t.textContent=n),o=P(_),f=T(_,"DIV",{class:!0,"data-tip":!0});var b=S(f);Y(g.$$.fragment,b),b.forEach(v),u=P(_),h&&h.l(_),_.forEach(v),d=P(c),r=T(c,"DIV",{class:!0});var B=S(r);for(let z=0;z<w.length;z+=1)w[z].l(B);B.forEach(v),this.h()},h(){p(s,"class","mt-1 md:mt-0"),p(t,"class","opacity-75 mr-1 md:mr-2"),p(f,"class","tooltip tooltip-top mr-1 md:mr-2 hidden md:block"),p(f,"data-tip","This is shown because you're an admin. Your visitors will not see this section."),p(e,"class",a="flex mt-1 md:mt-4 items-start text-left text-sm md:text-md "+i[2]),p(r,"class",m="aaaflex mt-1 md:mt-3 items-start text-left text-sm md:text-md "+i[2])},m(c,_){E(c,s,_),E(c,l,_),E(c,e,_),y(e,t),y(e,o),y(e,f),J(g,f,null),y(e,u),h&&h.m(e,null),E(c,d,_),E(c,r,_);for(let b=0;b<w.length;b+=1)w[b]&&w[b].m(r,null);k=!0},p(c,_){if(c[3]?h?(h.p(c,_),_&8&&A(h,1)):(h=ae(c),h.c(),A(h,1),h.m(e,null)):h&&(K(),j(h,1,1,()=>{h=null}),L()),(!k||_&4&&a!==(a="flex mt-1 md:mt-4 items-start text-left text-sm md:text-md "+c[2]))&&p(e,"class",a),_&19){O=V(Object.entries(le(c[0],c[1],c[4])));let b;for(b=0;b<O.length;b+=1){const B=se(c,O,b);w[b]?(w[b].p(B,_),A(w[b],1)):(w[b]=fe(B),w[b].c(),A(w[b],1),w[b].m(r,null))}for(K(),b=O.length;b<w.length;b+=1)ge(b);L()}(!k||_&4&&m!==(m="aaaflex mt-1 md:mt-3 items-start text-left text-sm md:text-md "+c[2]))&&p(r,"class",m)},i(c){if(!k){A(g.$$.fragment,c),A(h);for(let _=0;_<O.length;_+=1)A(w[_]);k=!0}},o(c){j(g.$$.fragment,c),j(h),w=w.filter(Boolean);for(let _=0;_<w.length;_+=1)j(w[_]);k=!1},d(c){c&&(v(s),v(l),v(e),v(d),v(r)),X(g),h&&h.d(),Q(w,c)}}}function ae(i){let s,l,e,t,n,o,f;t=new xe({});let g=V(Object.entries(W(i[4]))),u=[];for(let a=0;a<g.length;a+=1)u[a]=ue(ie(i,g,a));return{c(){s=x("div"),l=x("div"),e=x("span"),U(t.$$.fragment),n=N(),o=x("ul");for(let a=0;a<u.length;a+=1)u[a].c();this.h()},l(a){s=T(a,"DIV",{class:!0});var d=S(s);l=T(d,"DIV",{tabindex:!0,class:!0,"data-tip":!0});var r=S(l);e=T(r,"SPAN",{class:!0});var m=S(e);Y(t.$$.fragment,m),m.forEach(v),r.forEach(v),n=P(d),o=T(d,"UL",{tabindex:!0,class:!0});var k=S(o);for(let h=0;h<u.length;h+=1)u[h].l(k);k.forEach(v),d.forEach(v),this.h()},h(){p(e,"class","w-5 md:w-6 text-green-500 cursor-pointer tooltip tooltip-primary tooltip-right text-left left"),p(l,"tabindex","0"),p(l,"class","tooltip tooltip-primary tooltip-top flex"),p(l,"data-tip","Add this to section"),p(o,"tabindex","0"),p(o,"class","dropdown-content menu shadow bg-base-300 rounded-box w-80 rounded border border-gray-400 z-[100]"),p(s,"class","dropdown dropdown-bottom")},m(a,d){E(a,s,d),y(s,l),y(l,e),J(t,e,null),y(s,n),y(s,o);for(let r=0;r<u.length;r+=1)u[r]&&u[r].m(o,null);f=!0},p(a,d){if(d&19){g=V(Object.entries(W(a[4])));let r;for(r=0;r<g.length;r+=1){const m=ie(a,g,r);u[r]?u[r].p(m,d):(u[r]=ue(m),u[r].c(),u[r].m(o,null))}for(;r<u.length;r+=1)u[r].d(1);u.length=g.length}},i(a){f||(A(t.$$.fragment,a),f=!0)},o(a){j(t.$$.fragment,a),f=!1},d(a){a&&v(s),X(t),Q(u,a)}}}function re(i){let s,l,e=i[12].title+"",t,n,o=i[16].title+"",f,g,u;function a(){return i[5](i[11],i[15])}return{c(){s=x("li"),l=x("a"),t=G(e),n=G(" - "),f=G(o)},l(d){s=T(d,"LI",{});var r=S(s);l=T(r,"A",{});var m=S(l);t=F(m,e),n=F(m," - "),f=F(m,o),m.forEach(v),r.forEach(v)},m(d,r){E(d,s,r),y(s,l),y(l,t),y(l,n),y(l,f),g||(u=me(l,"click",a),g=!0)},p(d,r){i=d,r&16&&e!==(e=i[12].title+"")&&q(t,e),r&16&&o!==(o=i[16].title+"")&&q(f,o)},d(d){d&&v(s),g=!1,u()}}}function ce(i){let s=i[16]?.params?.sectionType&&i[16]?.params?.sectionType.includes(i[1]),l,e=s&&re(i);return{c(){e&&e.c(),l=C()},l(t){e&&e.l(t),l=C()},m(t,n){e&&e.m(t,n),E(t,l,n)},p(t,n){n&18&&(s=t[16]?.params?.sectionType&&t[16]?.params?.sectionType.includes(t[1])),s?e?e.p(t,n):(e=re(t),e.c(),e.m(l.parentNode,l)):e&&(e.d(1),e=null)},d(t){t&&v(l),e&&e.d(t)}}}function ue(i){let s,l=V(Object.entries(H(i[11]).sections)),e=[];for(let t=0;t<l.length;t+=1)e[t]=ce(ne(i,l,t));return{c(){for(let t=0;t<e.length;t+=1)e[t].c();s=C()},l(t){for(let n=0;n<e.length;n+=1)e[n].l(t);s=C()},m(t,n){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(t,n);E(t,s,n)},p(t,n){if(n&19){l=V(Object.entries(H(t[11]).sections));let o;for(o=0;o<l.length;o+=1){const f=ne(t,l,o);e[o]?e[o].p(f,n):(e[o]=ce(f),e[o].c(),e[o].m(s.parentNode,s))}for(;o<e.length;o+=1)e[o].d(1);e.length=l.length}},d(t){t&&v(s),Q(e,t)}}}function fe(i){let s,l,e,t,n,o=i[8]+"",f,g,u,a,d;e=new Te({});function r(){return i[6](i[7])}return{c(){s=x("div"),l=x("span"),U(e.$$.fragment),t=N(),n=x("span"),f=G(o),g=N(),this.h()},l(m){s=T(m,"DIV",{class:!0});var k=S(s);l=T(k,"SPAN",{class:!0,"data-tip":!0});var h=S(l);Y(e.$$.fragment,h),h.forEach(v),t=P(k),n=T(k,"SPAN",{class:!0});var O=S(n);f=F(O,o),O.forEach(v),g=P(k),k.forEach(v),this.h()},h(){p(l,"class","w-5 md:w-6 text-rose-500 cursor-pointer tooltip tooltip-primary tooltip-right"),p(l,"data-tip","Remove this from section"),p(n,"class","md:ml-1 align-top"),p(s,"class","w-max flow mb-0 opacity-75")},m(m,k){E(m,s,k),y(s,l),J(e,l,null),y(s,t),y(s,n),y(n,f),y(s,g),u=!0,a||(d=me(l,"click",ke(r)),a=!0)},p(m,k){i=m,(!u||k&19)&&o!==(o=i[8]+"")&&q(f,o)},i(m){u||(A(e.$$.fragment,m),u=!0)},o(m){j(e.$$.fragment,m),u=!1},d(m){m&&v(s),X(e),a=!1,d()}}}function je(i){let s=Object.keys(i[4]).length>0,l,e,t=s&&oe(i);return{c(){t&&t.c(),l=C()},l(n){t&&t.l(n),l=C()},m(n,o){t&&t.m(n,o),E(n,l,o),e=!0},p(n,[o]){o&16&&(s=Object.keys(n[4]).length>0),s?t?(t.p(n,o),o&16&&A(t,1)):(t=oe(n),t.c(),A(t,1),t.m(l.parentNode,l)):t&&(K(),j(t,1,1,()=>{t=null}),L())},i(n){e||(A(t),e=!0)},o(n){j(t),e=!1},d(n){n&&v(l),t&&t.d(n)}}}function Ne(i,s,l){let e;we(i,D,a=>l(4,e=a));let{itemId:t}=s,{entityName:n}=s,{classOverride:o="text-black dark:text-white"}=s,{showAddActions:f=!0}=s;const g=(a,d)=>{Se(a,d,t,n),document.activeElement.blur()},u=a=>Ae(a.split("-")[0],a.split("-")[1],t,n);return i.$$set=a=>{"itemId"in a&&l(0,t=a.itemId),"entityName"in a&&l(1,n=a.entityName),"classOverride"in a&&l(2,o=a.classOverride),"showAddActions"in a&&l(3,f=a.showAddActions)},[t,n,o,f,e,g,u]}class Ie extends he{constructor(s){super(),_e(this,s,Ne,je,de,{itemId:0,entityName:1,classOverride:2,showAddActions:3})}}export{Ie as A,H as a,Fe as g,Be as p,Ge as s};
